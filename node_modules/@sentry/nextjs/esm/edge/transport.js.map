{"version":3,"file":"transport.js","sources":["../../../src/edge/transport.ts"],"sourcesContent":["import { createTransport } from '@sentry/core';\nimport type { BaseTransportOptions, Transport, TransportMakeRequestResponse, TransportRequest } from '@sentry/types';\n\nexport interface EdgeTransportOptions extends BaseTransportOptions {\n  /** Fetch API init parameters. Used by the FetchTransport */\n  fetchOptions?: RequestInit;\n  /** Custom headers for the transport. Used by the XHRTransport and FetchTransport */\n  headers?: { [key: string]: string };\n}\n\n/**\n * Creates a Transport that uses the Edge Runtimes native fetch API to send events to Sentry.\n */\nexport function makeEdgeTransport(options: EdgeTransportOptions): Transport {\n  function makeRequest(request: TransportRequest): PromiseLike<TransportMakeRequestResponse> {\n    const requestOptions: RequestInit = {\n      body: request.body,\n      method: 'POST',\n      referrerPolicy: 'origin',\n      headers: options.headers,\n      ...options.fetchOptions,\n    };\n\n    try {\n      return fetch(options.url, requestOptions).then(response => ({\n        statusCode: response.status,\n        headers: {\n          'x-sentry-rate-limits': response.headers.get('X-Sentry-Rate-Limits'),\n          'retry-after': response.headers.get('Retry-After'),\n        },\n      }));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  }\n\n  return createTransport(options, makeRequest);\n}\n"],"names":[],"mappings":";;AAUA;AACA;AACA;AACA,SAAA,iBAAA,CAAA,OAAA,EAAA;AACA,EAAA,SAAA,WAAA,CAAA,OAAA,EAAA;AACA,IAAA,MAAA,cAAA,GAAA;AACA,MAAA,IAAA,EAAA,OAAA,CAAA,IAAA;AACA,MAAA,MAAA,EAAA,MAAA;AACA,MAAA,cAAA,EAAA,QAAA;AACA,MAAA,OAAA,EAAA,OAAA,CAAA,OAAA;AACA,MAAA,GAAA,OAAA,CAAA,YAAA;AACA,KAAA,CAAA;AACA;AACA,IAAA,IAAA;AACA,MAAA,OAAA,KAAA,CAAA,OAAA,CAAA,GAAA,EAAA,cAAA,CAAA,CAAA,IAAA,CAAA,QAAA,KAAA;AACA,QAAA,UAAA,EAAA,QAAA,CAAA,MAAA;AACA,QAAA,OAAA,EAAA;AACA,UAAA,sBAAA,EAAA,QAAA,CAAA,OAAA,CAAA,GAAA,CAAA,sBAAA,CAAA;AACA,UAAA,aAAA,EAAA,QAAA,CAAA,OAAA,CAAA,GAAA,CAAA,aAAA,CAAA;AACA,SAAA;AACA,OAAA,CAAA,CAAA,CAAA;AACA,KAAA,CAAA,OAAA,CAAA,EAAA;AACA,MAAA,OAAA,OAAA,CAAA,MAAA,CAAA,CAAA,CAAA,CAAA;AACA,KAAA;AACA,GAAA;AACA;AACA,EAAA,OAAA,eAAA,CAAA,OAAA,EAAA,WAAA,CAAA,CAAA;AACA;;;;"}